version: '3'
services:
  steven:
    build:
      context: .
      args:
          CUDA_VERSION: 10.2 #Get from nvidia-smi
          OS_VERSION: 18.04
          uid: 1006 #Tongping
          gid: 1006 #Tongping
    volumes:
      - /home/tongping/steven:/steven
    network_mode: host
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]

  test:
    image: nvidia/cuda:11.0-base-ubuntu20.04
    command: nvidia-smi
    deploy:
      resources:
        reservations:
          devices:
            - driver: nvidia
              count: 1
              capabilities: [gpu]

